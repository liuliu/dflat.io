
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <link rel="canonical" href="https://dflat.io/reference/SQLiteWorkspace/">
      
      
        <meta name="author" content="Liu Liu">
      
      <link rel="shortcut icon" href="../../favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-6.1.0">
    
    
      
        <title>SQLiteWorkspace - 「Dflat」Structured Data Store for Mobile</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.bc7e593a.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab28b872.min.css">
        
          
          
          <meta name="theme-color" content="#7e56c2">
        
      
    
    
    
      
        
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="deep-purple" data-md-color-accent="amber">
      
  
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#sqliteworkspace" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="https://dflat.io" title="「Dflat」Structured Data Store for Mobile" class="md-header-nav__button md-logo" aria-label="「Dflat」Structured Data Store for Mobile">
      
  <img src="../../images/logo.svg" alt="logo">

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            「Dflat」Structured Data Store for Mobile
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              SQLiteWorkspace
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/liuliu/dflat" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    liuliu/dflat
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://dflat.io" title="「Dflat」Structured Data Store for Mobile" class="md-nav__button md-logo" aria-label="「Dflat」Structured Data Store for Mobile">
      
  <img src="../../images/logo.svg" alt="logo">

    </a>
    「Dflat」Structured Data Store for Mobile
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/liuliu/dflat" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    liuliu/dflat
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../getting-started/" class="md-nav__link">
      Getting Started
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../runtime-api/" class="md-nav__link">
      Runtime API
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" checked>
    
    <label class="md-nav__link" for="nav-4">
      API Reference
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="API Reference" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        <span class="md-nav__icon md-icon"></span>
        API Reference
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../runtime-api/" class="md-nav__link">
      Runtime API
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Workspace/" class="md-nav__link">
      Workspace
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../TransactionContext/" class="md-nav__link">
      TransactionContext
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        SQLiteWorkspace
        <span class="md-nav__icon md-icon"></span>
      </label>
    
    <a href="./" class="md-nav__link md-nav__link--active">
      SQLiteWorkspace
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#properties" class="md-nav__link">
    Properties
  </a>
  
    <nav class="md-nav" aria-label="Properties">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dictionary" class="md-nav__link">
    dictionary
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#methods" class="md-nav__link">
    Methods
  </a>
  
    <nav class="md-nav" aria-label="Methods">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#initfilepathfileprotectionlevelsynchronouswriteconcurrencytargetqueue" class="md-nav__link">
    init(filePath:fileProtectionLevel:synchronous:writeConcurrency:targetQueue:)
  </a>
  
    <nav class="md-nav" aria-label="init(filePath:fileProtectionLevel:synchronous:writeConcurrency:targetQueue:)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#shutdowncompletion" class="md-nav__link">
    shutdown(completion:)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#performchanges_changeshandlercompletionhandler" class="md-nav__link">
    performChanges(_:changesHandler:completionHandler:)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fetchfor" class="md-nav__link">
    fetch(for:)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fetchwithinasnapshot_" class="md-nav__link">
    fetchWithinASnapshot(_:)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#subscribefetchedresultchangehandler" class="md-nav__link">
    subscribe(fetchedResult:changeHandler:)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#subscribeobjectchangehandler" class="md-nav__link">
    subscribe(object:changeHandler:)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#publisherfor" class="md-nav__link">
    publisher(for:)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#publisherfor_1" class="md-nav__link">
    publisher(for:)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#publisherfor_2" class="md-nav__link">
    publisher(for:)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../notes/trade-offs/" class="md-nav__link">
      Trade Offs
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Technical Notes
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Technical Notes" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        <span class="md-nav__icon md-icon"></span>
        Technical Notes
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../notes/trade-offs/" class="md-nav__link">
      Features & Trade Offs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../notes/mwmr/" class="md-nav__link">
      MWMR
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../notes/rowid/" class="md-nav__link">
      Rowid & ChangesTimestamp
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../notes/upgrade/" class="md-nav__link">
      Schema Upgrade
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../schema/" class="md-nav__link">
      Schema Evolution
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../namespace/" class="md-nav__link">
      Namespace
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../benchmark/" class="md-nav__link">
      Benchmark
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../acknowledgement/" class="md-nav__link">
      Acknowledgement
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#properties" class="md-nav__link">
    Properties
  </a>
  
    <nav class="md-nav" aria-label="Properties">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dictionary" class="md-nav__link">
    dictionary
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#methods" class="md-nav__link">
    Methods
  </a>
  
    <nav class="md-nav" aria-label="Methods">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#initfilepathfileprotectionlevelsynchronouswriteconcurrencytargetqueue" class="md-nav__link">
    init(filePath:fileProtectionLevel:synchronous:writeConcurrency:targetQueue:)
  </a>
  
    <nav class="md-nav" aria-label="init(filePath:fileProtectionLevel:synchronous:writeConcurrency:targetQueue:)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#shutdowncompletion" class="md-nav__link">
    shutdown(completion:)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#performchanges_changeshandlercompletionhandler" class="md-nav__link">
    performChanges(_:changesHandler:completionHandler:)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fetchfor" class="md-nav__link">
    fetch(for:)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fetchwithinasnapshot_" class="md-nav__link">
    fetchWithinASnapshot(_:)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#subscribefetchedresultchangehandler" class="md-nav__link">
    subscribe(fetchedResult:changeHandler:)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#subscribeobjectchangehandler" class="md-nav__link">
    subscribe(object:changeHandler:)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#publisherfor" class="md-nav__link">
    publisher(for:)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#publisherfor_1" class="md-nav__link">
    publisher(for:)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#publisherfor_2" class="md-nav__link">
    publisher(for:)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <p><strong>CLASS</strong></p>
<h1 id="sqliteworkspace"><code>SQLiteWorkspace</code><a class="headerlink" href="#sqliteworkspace" title="Permanent link">&para;</a></h1>
<div class="codehilite"><pre><span></span><code><span class="kd">public</span> <span class="kr">final</span> <span class="kd">class</span> <span class="nc">SQLiteWorkspace</span><span class="p">:</span> <span class="n">Workspace</span>
</code></pre></div>

<h2 id="properties">Properties<a class="headerlink" href="#properties" title="Permanent link">&para;</a></h2>
<h3 id="dictionary"><code>dictionary</code><a class="headerlink" href="#dictionary" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><code><span class="kd">public</span> <span class="kd">var</span> <span class="nv">dictionary</span><span class="p">:</span> <span class="n">WorkspaceDictionary</span>
</code></pre></div>

<h2 id="methods">Methods<a class="headerlink" href="#methods" title="Permanent link">&para;</a></h2>
<h3 id="initfilepathfileprotectionlevelsynchronouswriteconcurrencytargetqueue"><code>init(filePath:fileProtectionLevel:synchronous:writeConcurrency:targetQueue:)</code><a class="headerlink" href="#initfilepathfileprotectionlevelsynchronouswriteconcurrencytargetqueue" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><code><span class="kd">public</span> <span class="kr">required</span> <span class="kd">init</span><span class="p">(</span>
  <span class="n">filePath</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span> <span class="n">fileProtectionLevel</span><span class="p">:</span> <span class="n">FileProtectionLevel</span><span class="p">,</span> <span class="n">synchronous</span><span class="p">:</span> <span class="n">Synchronous</span> <span class="p">=</span> <span class="p">.</span><span class="n">normal</span><span class="p">,</span>
  <span class="n">writeConcurrency</span><span class="p">:</span> <span class="n">WriteConcurrency</span> <span class="p">=</span> <span class="p">.</span><span class="n">concurrent</span><span class="p">,</span> <span class="n">targetQueue</span><span class="p">:</span> <span class="n">DispatchQueue</span><span class="p">?</span> <span class="p">=</span> <span class="kc">nil</span>
<span class="p">)</span>
</code></pre></div>

<p>Return a SQLite backed Workspace instance.</p>
<ul>
<li>Parameters:<ul>
<li>filePath: The path to the SQLite file. There will be 3 files named filePath, "(filePath)-wal" and "(filePath)-shm" created.</li>
<li>fileProtectionLevel: The expected protection level for the database file.</li>
<li>synchronous: The SQLite synchronous mode, read: https://www.sqlite.org/wal.html#performance_considerations</li>
<li>writeConcurrency: Either <code>.concurrent</code> or <code>.serial</code>.</li>
<li>targetQueue: If nil, we will create a queue based on writeConcurrency settings. If you supply your own queue, please read
               about WriteConcurrency before proceed.</li>
</ul>
</li>
</ul>
<h4 id="parameters">Parameters<a class="headerlink" href="#parameters" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>filePath</td>
<td>The path to the SQLite file. There will be 3 files named filePath, “(filePath)-wal” and “(filePath)-shm” created.</td>
</tr>
<tr>
<td>fileProtectionLevel</td>
<td>The expected protection level for the database file.</td>
</tr>
<tr>
<td>synchronous</td>
<td>The SQLite synchronous mode, read: https://www.sqlite.org/wal.html#performance_considerations</td>
</tr>
<tr>
<td>writeConcurrency</td>
<td>Either <code>.concurrent</code> or <code>.serial</code>.</td>
</tr>
<tr>
<td>targetQueue</td>
<td>If nil, we will create a queue based on writeConcurrency settings. If you supply your own queue, please read about WriteConcurrency before proceed.</td>
</tr>
</tbody>
</table>
<h3 id="shutdowncompletion"><code>shutdown(completion:)</code><a class="headerlink" href="#shutdowncompletion" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><code><span class="kd">public</span> <span class="kd">func</span> <span class="nf">shutdown</span><span class="p">(</span><span class="n">completion</span><span class="p">:</span> <span class="p">(()</span> <span class="p">-&gt;</span> <span class="nb">Void</span><span class="p">)?)</span>
</code></pre></div>

<h3 id="performchanges_changeshandlercompletionhandler"><code>performChanges(_:changesHandler:completionHandler:)</code><a class="headerlink" href="#performchanges_changeshandlercompletionhandler" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><code><span class="kd">public</span> <span class="kd">func</span> <span class="nf">performChanges</span><span class="p">(</span>
  <span class="kc">_</span> <span class="n">transactionalObjectTypes</span><span class="p">:</span> <span class="p">[</span><span class="nb">Any</span><span class="p">.</span><span class="kr">Type</span><span class="p">],</span> <span class="n">changesHandler</span><span class="p">:</span> <span class="p">@</span><span class="n">escaping</span> <span class="n">Workspace</span><span class="p">.</span><span class="n">ChangesHandler</span><span class="p">,</span>
  <span class="n">completionHandler</span><span class="p">:</span> <span class="n">Workspace</span><span class="p">.</span><span class="n">CompletionHandler</span><span class="p">?</span> <span class="p">=</span> <span class="kc">nil</span>
<span class="p">)</span>
</code></pre></div>

<h3 id="fetchfor"><code>fetch(for:)</code><a class="headerlink" href="#fetchfor" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><code><span class="kd">public</span> <span class="kd">func</span> <span class="nf">fetch</span><span class="p">&lt;</span><span class="n">Element</span><span class="p">:</span> <span class="n">Atom</span><span class="p">&gt;(</span><span class="k">for</span> <span class="n">ofType</span><span class="p">:</span> <span class="n">Element</span><span class="p">.</span><span class="kr">Type</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="n">QueryBuilder</span><span class="p">&lt;</span><span class="n">Element</span><span class="p">&gt;</span>
</code></pre></div>

<h3 id="fetchwithinasnapshot_"><code>fetchWithinASnapshot(_:)</code><a class="headerlink" href="#fetchwithinasnapshot_" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><code><span class="kd">public</span> <span class="kd">func</span> <span class="nf">fetchWithinASnapshot</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;(</span><span class="kc">_</span> <span class="n">closure</span><span class="p">:</span> <span class="p">()</span> <span class="p">-&gt;</span> <span class="n">T</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="n">T</span>
</code></pre></div>

<h3 id="subscribefetchedresultchangehandler"><code>subscribe(fetchedResult:changeHandler:)</code><a class="headerlink" href="#subscribefetchedresultchangehandler" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><code><span class="kd">public</span> <span class="kd">func</span> <span class="nf">subscribe</span><span class="p">&lt;</span><span class="n">Element</span><span class="p">:</span> <span class="n">Atom</span><span class="p">&gt;(</span>
  <span class="n">fetchedResult</span><span class="p">:</span> <span class="n">FetchedResult</span><span class="p">&lt;</span><span class="n">Element</span><span class="p">&gt;,</span>
  <span class="n">changeHandler</span><span class="p">:</span> <span class="p">@</span><span class="n">escaping</span> <span class="p">(</span><span class="kc">_</span><span class="p">:</span> <span class="n">FetchedResult</span><span class="p">&lt;</span><span class="n">Element</span><span class="p">&gt;)</span> <span class="p">-&gt;</span> <span class="nb">Void</span>
<span class="p">)</span> <span class="p">-&gt;</span> <span class="n">Workspace</span><span class="p">.</span><span class="n">Subscription</span> <span class="k">where</span> <span class="n">Element</span><span class="p">:</span> <span class="nb">Equatable</span>
</code></pre></div>

<h3 id="subscribeobjectchangehandler"><code>subscribe(object:changeHandler:)</code><a class="headerlink" href="#subscribeobjectchangehandler" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><code><span class="kd">public</span> <span class="kd">func</span> <span class="nf">subscribe</span><span class="p">&lt;</span><span class="n">Element</span><span class="p">:</span> <span class="n">Atom</span><span class="p">&gt;(</span>
  <span class="n">object</span><span class="p">:</span> <span class="n">Element</span><span class="p">,</span> <span class="n">changeHandler</span><span class="p">:</span> <span class="p">@</span><span class="n">escaping</span> <span class="p">(</span><span class="kc">_</span><span class="p">:</span> <span class="n">SubscribedObject</span><span class="p">&lt;</span><span class="n">Element</span><span class="p">&gt;)</span> <span class="p">-&gt;</span> <span class="nb">Void</span>
<span class="p">)</span> <span class="p">-&gt;</span> <span class="n">Workspace</span><span class="p">.</span><span class="n">Subscription</span> <span class="k">where</span> <span class="n">Element</span><span class="p">:</span> <span class="nb">Equatable</span>
</code></pre></div>

<h3 id="publisherfor"><code>publisher(for:)</code><a class="headerlink" href="#publisherfor" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><code><span class="kd">public</span> <span class="kd">func</span> <span class="nf">publisher</span><span class="p">&lt;</span><span class="n">Element</span><span class="p">:</span> <span class="n">Atom</span><span class="p">&gt;(</span><span class="k">for</span> <span class="n">object</span><span class="p">:</span> <span class="n">Element</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="n">AtomPublisher</span><span class="p">&lt;</span><span class="n">Element</span><span class="p">&gt;</span>
<span class="k">where</span> <span class="n">Element</span><span class="p">:</span> <span class="nb">Equatable</span>
</code></pre></div>

<h3 id="publisherfor_1"><code>publisher(for:)</code><a class="headerlink" href="#publisherfor_1" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><code><span class="kd">public</span> <span class="kd">func</span> <span class="nf">publisher</span><span class="p">&lt;</span><span class="n">Element</span><span class="p">:</span> <span class="n">Atom</span><span class="p">&gt;(</span><span class="k">for</span> <span class="n">fetchedResult</span><span class="p">:</span> <span class="n">FetchedResult</span><span class="p">&lt;</span><span class="n">Element</span><span class="p">&gt;)</span>
  <span class="p">-&gt;</span> <span class="n">FetchedResultPublisher</span><span class="p">&lt;</span><span class="n">Element</span><span class="p">&gt;</span> <span class="k">where</span> <span class="n">Element</span><span class="p">:</span> <span class="nb">Equatable</span>
</code></pre></div>

<h3 id="publisherfor_2"><code>publisher(for:)</code><a class="headerlink" href="#publisherfor_2" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><code><span class="kd">public</span> <span class="kd">func</span> <span class="nf">publisher</span><span class="p">&lt;</span><span class="n">Element</span><span class="p">:</span> <span class="n">Atom</span><span class="p">&gt;(</span><span class="k">for</span><span class="p">:</span> <span class="n">Element</span><span class="p">.</span><span class="kr">Type</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="n">QueryPublisherBuilder</span><span class="p">&lt;</span><span class="n">Element</span><span class="p">&gt;</span>
<span class="k">where</span> <span class="n">Element</span><span class="p">:</span> <span class="nb">Equatable</span>
</code></pre></div>

<p><strong>ENUM</strong></p>
<h1 id="sqliteworkspacefileprotectionlevel"><code>SQLiteWorkspace.FileProtectionLevel</code><a class="headerlink" href="#sqliteworkspacefileprotectionlevel" title="Permanent link">&para;</a></h1>
<div class="codehilite"><pre><span></span><code><span class="kd">public</span> <span class="kd">enum</span> <span class="nc">FileProtectionLevel</span><span class="p">:</span> <span class="nb">Int32</span>
</code></pre></div>

<h2 id="cases">Cases<a class="headerlink" href="#cases" title="Permanent link">&para;</a></h2>
<h3 id="noprotection"><code>noProtection</code><a class="headerlink" href="#noprotection" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><code><span class="k">case</span> <span class="n">noProtection</span> <span class="p">=</span> <span class="mi">4</span>
</code></pre></div>

<p>Class D: No protection. If the device is booted, in theory, you can access the content.
When it is not booted, the content is protected by the Secure Enclave's hardware key.</p>
<h3 id="completefileprotection"><code>completeFileProtection</code><a class="headerlink" href="#completefileprotection" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><code><span class="k">case</span> <span class="n">completeFileProtection</span> <span class="p">=</span> <span class="mi">1</span>
</code></pre></div>

<p>Class A: The file is accessible if the phone is unlocked and the app is in foreground.
You will lose the file access if the app is backgrounded or the phone is locked.</p>
<h3 id="completefileprotectionunlessopen"><code>completeFileProtectionUnlessOpen</code><a class="headerlink" href="#completefileprotectionunlessopen" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><code><span class="k">case</span> <span class="n">completeFileProtectionUnlessOpen</span> <span class="p">=</span> <span class="mi">2</span>
</code></pre></div>

<p>Class B: The file is accessible if the phone is unlocked. You will lose the file access
if the phone is locked.</p>
<h3 id="completefileprotectionuntilfirstuserauthentication"><code>completeFileProtectionUntilFirstUserAuthentication</code><a class="headerlink" href="#completefileprotectionuntilfirstuserauthentication" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><code><span class="k">case</span> <span class="n">completeFileProtectionUntilFirstUserAuthentication</span> <span class="p">=</span> <span class="mi">3</span>
</code></pre></div>

<p>Class C: The file is accessible once user unlocked the phone once. The file cannot be
accessed prior to that. For example, if you received a notification before first device
unlock, the underlying database cannot be open successfully.</p>
<p><strong>ENUM</strong></p>
<h1 id="sqliteworkspacewriteconcurrency"><code>SQLiteWorkspace.WriteConcurrency</code><a class="headerlink" href="#sqliteworkspacewriteconcurrency" title="Permanent link">&para;</a></h1>
<div class="codehilite"><pre><span></span><code><span class="kd">public</span> <span class="kd">enum</span> <span class="nc">WriteConcurrency</span>
</code></pre></div>

<h2 id="cases_1">Cases<a class="headerlink" href="#cases_1" title="Permanent link">&para;</a></h2>
<h3 id="concurrent"><code>concurrent</code><a class="headerlink" href="#concurrent" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><code><span class="k">case</span> <span class="n">concurrent</span>
</code></pre></div>

<p>Enable strict serializable multi-writer / multi-reader mode. Note that SQLite under the
hood still writes serially. It only means the transaction closures can be executed
concurrently. If you provided a targetQueue, please make sure it is a concurrent queue
otherwise it will still execute transaction closure serially. The targetQueue is supplied
by you, should be at reasonable priority, at least <code>.default</code>, because it sets the ceiling
for any sub-queues targeting that, and we may need to bump the sub-queues depending on
where you <code>performChanges</code>.</p>
<h3 id="serial"><code>serial</code><a class="headerlink" href="#serial" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><code><span class="k">case</span> <span class="n">serial</span>
</code></pre></div>

<p>Enable single-writer / multi-reader mode. This will execute transaction closures serially.
If you supply a targetQueue, please make sure it is serial. It is safe for this serial queue
to have lower priority such as <code>.utility</code>, because we can bump the priority based on where
you call <code>performChanges</code>.</p>
<p><strong>ENUM</strong></p>
<h1 id="sqliteworkspacesynchronous"><code>SQLiteWorkspace.Synchronous</code><a class="headerlink" href="#sqliteworkspacesynchronous" title="Permanent link">&para;</a></h1>
<div class="codehilite"><pre><span></span><code><span class="kd">public</span> <span class="kd">enum</span> <span class="nc">Synchronous</span>
</code></pre></div>

<p>The synchronous mode of SQLite. We defaults to <code>.normal</code>. Read more on: <a href="https://www.sqlite.org/wal.html#performance_considerations">https://www.sqlite.org/wal.html#performance_considerations</a></p>
<h2 id="cases_2">Cases<a class="headerlink" href="#cases_2" title="Permanent link">&para;</a></h2>
<h3 id="normal"><code>normal</code><a class="headerlink" href="#normal" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><code><span class="k">case</span> <span class="n">normal</span>
</code></pre></div>

<h3 id="full"><code>full</code><a class="headerlink" href="#full" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><code><span class="k">case</span> <span class="n">full</span>
</code></pre></div>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../TransactionContext/" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                TransactionContext
              </div>
            </div>
          </a>
        
        
          <a href="../../notes/trade-offs/" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Trade Offs
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
  <div class="md-footer-social">
    
      
      
        
        
      
      <a href="https://twitter.com/liuliu" target="_blank" rel="noopener" title="twitter.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M22.46 6c-.77.35-1.6.58-2.46.69.88-.53 1.56-1.37 1.88-2.38-.83.5-1.75.85-2.72 1.05C18.37 4.5 17.26 4 16 4c-2.35 0-4.27 1.92-4.27 4.29 0 .34.04.67.11.98C8.28 9.09 5.11 7.38 3 4.79c-.37.63-.58 1.37-.58 2.15 0 1.49.75 2.81 1.91 3.56-.71 0-1.37-.2-1.95-.5v.03c0 2.08 1.48 3.82 3.44 4.21a4.22 4.22 0 01-1.93.07 4.28 4.28 0 004 2.98 8.521 8.521 0 01-5.33 1.84c-.34 0-.68-.02-1.02-.06C3.44 20.29 5.7 21 8.12 21 16 21 20.33 14.46 20.33 8.79c0-.19 0-.37-.01-.56.84-.6 1.56-1.36 2.14-2.23z"/></svg>
      </a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/vendor.6a3d08fc.min.js"></script>
      <script src="../../assets/javascripts/bundle.71201edf.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script>
      
      <script>
        app = initialize({
          base: "../..",
          features: ['tabs'],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.4ac00218.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
    
  </body>
</html>